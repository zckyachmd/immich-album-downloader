version: '3.8'

# Example Docker Compose configuration for Immich Album Downloader
# Copy this file to docker-compose.yml and update the environment variables

services:
  immich-album-downloader:
    image: ghcr.io/zckyachmd/immich-album-downloader:latest
    container_name: immich-album-downloader
    restart: unless-stopped

    environment:
      # Required: Immich server configuration
      - IMMICH_BASE_URL=https://your-immich-server.com/api
      - IMMICH_API_KEY=your_api_key_here

      # Optional: Output directory (default: /downloads)
      - DEFAULT_OUTPUT=/downloads

      # Optional: Download settings
      - IMMICH_CONCURRENCY=5
      - IMMICH_MAX_RETRIES=3
      - IMMICH_DOWNLOAD_TIMEOUT=30000

      # Optional: Rate limiting
      - IMMICH_RATE_LIMIT_REQUESTS=100
      - IMMICH_RATE_LIMIT_WINDOW_MS=60000

      # Optional: SSL/TLS (set to false for self-signed certificates)
      - IMMICH_SSL_VERIFY=true

    volumes:
      # Mount download directory to persist downloads
      - ./downloads:/downloads

      # Mount media-cache to persist database and logs
      - ./media-cache:/app/media-cache

    # Example commands:
    # - Interactive mode (default): no command needed
    # - Download all albums: command: ["--all"]
    # - Resume failed downloads: command: ["--resume-failed"]
    # - Dry run with verbose: command: ["--dry-run", "--verbose"]
    # - Download specific album: command: ["--only", "vacation"]
    # - Download with filters: command: ["--all", "--exclude", "memes", "--verbose"]

    # Uncomment and modify as needed:
    # command: ["--all"]
